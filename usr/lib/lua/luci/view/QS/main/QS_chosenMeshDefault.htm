<%-
   topheader=("You have chosen " .. network)
   subheading="This Network..."
   PageTitle="Network Configuration"
   buttons={
           { text="Go Back and Choose Again", icon="x", action="nearbyMesh"},
           { text="Customize This Network", icon="dot", action="uci?uci=name;last=chosenMeshDefault"}
   }

--list_items is the list of values. list_items[1] = {"name", value}, etc.
-%>
<!-- include("QS/module/QS_header") -->
<!-- Begin QS Header -->

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Are the favicon and stylesheet paths static or dynamic? -->
		<link type="image/png" href="<%=media%>/QS/images/favicon.ico" rel="shortcut icon" />
		<link rel="stylesheet" href="<%=media%>/QS/css/quickstart.css" type="text/css" />
		<!--script src="#" type="text/javascript"-->
		<!-- NEED: page title var in each page to be used in title and h1 -->
		<title><%=PageTitle%> | <%=node%></title>
	</head>
	<body>
		<div id="page">
<!-- End QS Header -->
<!-- include("QS/module/QS_infoBanner") -->
<!-- Begin QS infoBanner -->

<!--
		Seems like there should be a way to reuse this in logoInfoBanner
				-->
			<header>
				<!-- top level navigational elements -->
				<div class="navbar-inners">
					<div class="color0"></div>
					<div class="color1"></div>
					<div class="color2"></div>
					<div class="color3"></div>
					<div class="color4"></div>
				</div>
				<div id="zone-preface-wrapper">
					<div id="zone-preface">
						<hr />
						<!-- h1 functionally identical to title for accessibility -->
						<h1 style="font-size:3em"><%=topheader%></h1>
						<!-- Rest of header content -->
						<h2 style="font-size:1.5em"><%=subheading%></h2>
					</div>
				</div>
			</header>
<!-- End QS infoBanner -->
<!-- include("QS/module/QS_meshInfo") -->
<!-- Begin QS meshInfo -->
			<div id="zone-content-wrapper">
				<div id="zone-content">
					<%-
						 for _,x in ipairs(list_items) do
								 if x[1] == "gateway_sharing" then
										 gateway_sharing=x[2]
								 elseif x[1] == "app_sharing" then
										 app_sharing=x[2]
								 elseif x[1] == "network_key" then
										 network_key=x[2]
								 elseif x[1] == "security_counter" then
										 security_counter=x[2]
								 end
						 end
						 if security_counter == 0 then
								 sec_msg = "This network is insecure"
						 elseif security_counter == 2 then
								 sec_msg = "This network is somewhat secure"
						 elseif security_counter == 4 then
								 sec_msg = "This network is moderately secure"
						 elseif security_counter == 6 then
								 sec_msg = "This network is secure against casual attackers"
						 elseif security_counter == 8 then
										sec_msg = "This network has adequate security for most needs"
						 end
						 if network_key == false then
								 net_key_title = "Does NOT Require a Network Key"
								 net_key_help = "This network does NOT require a network password for new nodes"
								 net_key_subsection = "QS/module/null"
						 elseif network_key == "fail" then
								 net_key_title = "Require a Different Network Key"
								 net_key_help = "The network key you entered was incorect. Please upload the correct key."
								 net_key_subsection = "QS/module/QS_upload"
						 elseif network_key == "correct" then
								 net_key_title = "Uses the key you uploaded"
								 net_key_help = "You have uploaded the correct key for this network"
								 net_key_subsection = "QS/module/null"
						 else
								 net_key_title = "Requires A Network Key"
								 net_key_help = "This network requires a network password for new nodes"
								 --need to make upload use same backend but load different frontends when done.
								 file_instructions = "your network key here"
								 net_key_subsection = "QS/module/QS_upload"
						 end

						 if gate_share == true then
								 --We need to implement a check on the daemon to see if it can connect to the internet
								 gate_share_title = "Shares Gateway Connectivity"
								 gate_share_help = "This network has users currently sharing their access to the Internet"
						 else
								 gate_share_title = "Does NOT share Gateway Connectivity"
								 gate_share_help = "This network does NOT currently have access to the Internet"
						 end

						 if app_share == true then
								 --We need to do an MDNS check for this process
								 app_share_title = "Has Local Applications Running"
								 app_share_help = "This network currently has local applications running on it"
						 else
								 app_share_title = "Does NOT Require a Network Key"
								 app_share_help = "This network currently does NOT have local applications running on it"
						 end

						 -%>
						<ul>
							<li><strong><%=sec_msg%></strong></li>
							<li><strong><%=net_key_title%>:</strong>
								<%=net_key_help%>
								<%if net_key_subsection then%>
								<!-- include(net_key_subsection) -->
								<%uploadType = "key"%>
								<form method="post" action="/cgi-bin/luci/QS/upload" enctype="multipart/form-data">
								  <div class="cbi-section-node">
									<div class="cbi-value cbi-value-last<% if image_invalid then %> cbi-value-error<% end %>">
									  <div class="cbi-value-field">
										<input type="file" name="<%=uploadType%>" id="media" />
										<input type="hidden" name="next" value="tryNetwork">
										<input type="hidden" name="config" value="<%=network%>">
										<div class="cbi-section-descr"> Upload <%=file_instructions%> </div>
									  </div>
									</div>
								  </div>
								  <%end%>
							</li>
							
							<li><strong><%=gate_share_title%>:</strong>
							  <%=gate_share_help%>
							</li>
							<li><strong><%=app_share_title%></strong>
							  <%=app_share_help%>
							</li>
						</ul>
				</div>
			</div>
			<!-- End QS meshInfo -->
			<!-- include("QS/module/QS_buttons") -->
			<!-- Begin QS buttons -->
			
			<div id="zone-button-wrapper">
			  <div id="zone-buttons">
				<div class="button-wrapper">
				  <ul>
					<%-
					   for i,x in ipairs(buttons) do
					       text = x.text
					       icon = x.icon
					       action = x.action
					   -%>
					<li>
					  <a href="/cgi-bin/luci/QS/<%=action%>">
						<figure>
						  <img src="<%=media%>/QS/images/<%=icon%>.png" alt="<%=text%> Button" class="button" />
						  <figcaption><%=text%></figcaption>
						</figure>
					  </a>
					</li>
					<%end%>
					  <%if net_key_subsection then%>
					<li>
					  <a href="/cgi-bin/luci/QS/tryNetwork?config=<%=network%>">
						<figure>
						  <input type="image" src="<%=media%>/QS/images/plus.png" alt="Continue With This Network Button" value="Submit"><br />
						  <figcaption>Continue With This Network</figcaption>
						</figure>
					  </a>
					</li>
					
					<%else%>
 					<li>
					  <a href="/cgi-bin/luci/QS/tryNetwork?config=<%=network%>">
						<figure>
			  			  <img src="<%=media%>/QS/images/plus.png" alt="Continue With This Network Button" class="button" />
						  <figcaption>Continue With This Network</figcaption>
						</figure>
					  </a>
					</li>
					<%end%>
				  </ul>
				</div>
			  </div>
			</div>
			
			<!-- End QS buttons -->
			<!-- include("QS/module/QS_footer") -->
			<!-- Begin QS Footer -->
			
			<!-- include("QS/module/QS_adminButton") -->
			<!-- Begin QS adminButton -->
			
			<div id="zone-footer-wrapper">
			  <div id="zone-footer">
				<div class="button-wrapper">
				  <ul>
					<li>
					  <a href="#">
						<figure>
						  <img src="<%=media%>/QS/images/target_admin.png" alt="Advanced Config Button" class="button" />
						  <figcaption>Advanced Config</figcaption>
						</figure>
					  </a>
					</li>
					<li>
					  <a href="#">
						<figure>
						  <img src="<%=media%>/QS/images/help_admin.png" alt="Help Button" class="button" />
						  <figcaption>Help</figcaption>
						</figure>
					  </a>
					</li>
					<li>
					  <a href="#">
						<figure>
						  <img src="<%=media%>/QS/images/equal_admin.png" alt="Admin Menu Button" class="button" />
						  <figcaption>Admin Menu</figcaption>
						</figure>
					  </a>
					</li>
					<li>
					  <a href="#">
						<figure>
						  <img src="<%=media%>/QS/images/quit_admin.png" alt="Quit Quickstart Wizard Button" class="button" />
						  <figcaption>Quit</figcaption>
						</figure>
					  </a>
					</li>
				  </ul>
				</div>
			  </div>
			</div>
			<!-- End QS adminButton -->
		</div>
	</body>
</html>
<!-- End QS Footer -->
